/*
📞 天润客服接听数据统计
用途：统计客服每天接了多少个电话，按业务类型分类
就像统计"老师每天被同学问了多少个问题，分别是哪些科目的问题"
*/

select 
    fdate,                               -- 日期（哪一天）
    case when fivr_name like "%验货担保%" or fivr_name like "%验机%" then "验机" 
         when fivr_name like "%寄卖%" then "寄卖"
    else "回收" end as "渠道",
    -- ↑ 根据服务名称判断是什么业务类型：
    -- 如果服务名称包含"验货担保"或"验机"，就归类为"验机"业务
    -- 如果包含"寄卖"，就归类为"寄卖"业务  
    -- 其他的都归类为"回收"业务
    -- 就像根据课程名称判断是语文课还是数学课
    
    count(funique_id)                    -- 统计电话数量（数一数有多少个电话）
from ods.ods_kf_tianrun_describe_cdr_ib  -- 从"天润客服通话记录表"查找数据
where fdate>=to_date(date_sub(from_unixtime(unix_timestamp()),720))  -- 查看最近720天的记录
and fstatus='座席接听'                   -- 并且状态是"座席接听"（确实被客服接听了）
group by 1,2                            -- 按日期和渠道分组统计

/*
💡 简单解释：
这个查询就像问客服主管：
"给我统计一下最近2年，每天各种业务的客服电话接了多少个"

📊 结果会显示：
日期        | 渠道类型 | 电话数量
2024-01-01  | 验机     | 50个
2024-01-01  | 寄卖     | 30个  
2024-01-01  | 回收     | 100个

🔍 关键词解释：
- like "%验机%" = 包含"验机"这两个字（%是通配符，表示任意字符）
- count() = 计数（数有多少个）
- group by = 分组（把相同的归为一类）
*/




